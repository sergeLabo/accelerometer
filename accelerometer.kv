#:kivy 1.11.1
#:import Clock kivy.clock.Clock

<Accelerometer>:
    orientation: 'vertical'
    ActionBar:
        pos_hint: {"top": 1}
        icon: self.icon
        ActionView:
            use_separator: False
            ActionPrevious:
                markup: True
                title: '[b]Accelerometer[/b]'
                with_previous: False
                app_icon: './images/icon_labo_32.png'
                color: (1, 0, 0.5, 1)
                font_size: '[size]10sp[/size]'
                on_release: app.root.ids.sm.current = "main"
            ActionOverflow:
            # #ActionButton:
                # #icon: './images/icon_labo_32.png'
                # #on_release: app.root.ids.sm.current = "first"
            # #ActionGroup:
                # #text: 'Menu'
            ActionButton:
                text: 'Activité'
                on_release: app.root.ids.sm.current = "first"
            ActionButton:
                text: 'Courbe'
                on_release: app.root.ids.sm.current = "second"
            ActionButton:
                text: 'Options'
                on_release: app.open_settings()

    ScreenManager:
        id: sm
        MainScreen:
        Screen1:
        Screen2:

<MainScreen>:
    name: 'main'
    canvas.before:
        Rectangle:
            pos: self.pos
            size: self.size
            source: './images/labo_bgd.png'

    BoxLayout:
        orientation: "vertical"
        padding: 10, 10
        Button:
            text: '\n\n\n\n\n\n\n\n\n\n\n\n\nAccéléromètre'
            background_color: (0, 0, 0, 0)
            font_size: "28sp"
            on_press: app.root.ids.sm.current = "first"

<Screen1>:
    name: 'first'
    BoxLayout:
        orientation: 'vertical'
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: 0.25
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: 0.3
                Label:
                    id: activ_sensor
                    font_size: "22sp"
                    text: 'Capteur: '
                Label:
                    id: real_freq
                    font_size: "18sp"
                    text: 'Fréquence:'
            BoxLayout:
                orientation: 'horizontal'
                size_hint_y: 0.3
                Label:
                    id: num
                    font_size: "18sp"
                    text: 'N°:  0000'
                Label:
                    id: x_y_z
                    font_size: "18sp"
                    text: '0000: X: Y: Z:'
            Label:
                size_hint_y: 0.4
                id: activity_long
                font_size: "22sp"
                text: 'Assis'

        BoxLayout:
            size_hint_y: 0.07
            ToggleButton:
                id: acceleromer_status
                background_color: (0, 1.2, 0, 1)
                font_size: "18sp"
                text: "Lancer l'accéléromètre"
                on_press: root.on_sensor_enable()

        BoxLayout:
            orientation: 'vertical'
            size_hint_y: 0.58
            BoxLayout:
                orientation: 'horizontal'
                ToggleButton:
                    group: 'action'
                    id: action_0
                    background_color: (1, 0, 1, 1)
                    text: '0'
                    color: (0, 1, 0, 1)
                    font_size: "14sp"
                    on_press: root.on_activity(0)
                ToggleButton:
                    group: 'action'
                    id: action_1
                    background_color: (1, 0, 1, 1)
                    text: '1'
                    color: (0, 1, 0, 1)
                    font_size: "14sp"
                    on_press: root.on_activity(1)
            BoxLayout:
                orientation: 'horizontal'
                ToggleButton:
                    group: 'action'
                    id: action_2
                    background_color: (1, 0, 1, 1)
                    text: '2'
                    color: (0, 1, 0, 1)
                    font_size: "14sp"
                    on_press: root.on_activity(2)
                ToggleButton:
                    group: 'action'
                    id: action_3
                    background_color: (1, 0, 1, 1)
                    text: '3'
                    color: (0, 1, 0, 1)
                    font_size: "14sp"
                    on_press: root.on_activity(3)
            BoxLayout:
                orientation: 'horizontal'
                ToggleButton:
                    group: 'action'
                    id: action_4
                    background_color: (1, 0, 1, 1)
                    text: '0'
                    color: (0, 1, 0, 1)
                    font_size: "14sp"
                    on_press: root.on_activity(4)
                ToggleButton:
                    group: 'action'
                    id: action_5
                    background_color: (1, 0, 1, 1)
                    text: '1'
                    color: (0, 1, 0, 1)
                    font_size: "14sp"
                    on_press: root.on_activity(5)
            BoxLayout:
                orientation: 'horizontal'
                ToggleButton:
                    group: 'action'
                    id: action_6
                    background_color: (1, 0, 1, 1)
                    text: '0'
                    color: (0, 1, 0, 1)
                    font_size: "14sp"
                    on_press: root.on_activity(6)
                ToggleButton:
                    group: 'action'
                    id: action_7
                    background_color: (1, 0, 1, 1)
                    text: '1'
                    color: (0, 1, 0, 1)
                    font_size: "14sp"
                    on_press: root.on_activity(7)
            BoxLayout:
                orientation: 'horizontal'
                ToggleButton:
                    group: 'action'
                    id: action_8
                    background_color: (1, 0, 1, 1)
                    text: '0'
                    color: (0, 1, 0, 1)
                    font_size: "14sp"
                    on_press: root.on_activity(8)
                ToggleButton:
                    group: 'action'
                    id: action_9
                    background_color: (1, 0, 1, 1)
                    text: '1'
                    color: (0, 1, 0, 1)
                    font_size: "14sp"
                    on_press: root.on_activity(9)
            BoxLayout:
                orientation: 'horizontal'
                ToggleButton:
                    group: 'action'
                    id: action_10
                    background_color: (1, 0, 1, 1)
                    text: '0'
                    color: (0, 1, 0, 1)
                    font_size: "14sp"
                    on_press: root.on_activity(10)
                ToggleButton:
                    group: 'action'
                    id: action_11
                    background_color: (1, 0, 1, 1)
                    text: '1'
                    color: (0, 1, 0, 1)
                    font_size: "14sp"
                    on_press: root.on_activity(11)

        BoxLayout:
            size_hint_y: 0.07
            orientation: 'horizontal'
            Button:
                id: save_button
                markup: True
                background_color: (0, 1.2, 0, 1)
                font_size: "18sp"
                text: '[b]Courbe[/b]'
                on_release: app.root.ids.sm.current = "second"
            Button:
                id: save_npz
                background_color: (0, 1.2, 0, 1)
                font_size: "18sp"
                markup: True
                text: '[b]Enregistrement[/b]'
                on_press: root.do_save_npz()
                on_release: Clock.schedule_once(root.reset_save_npz_button, 2)
        BoxLayout:
            size_hint_y: 0.03
            orientation: 'horizontal'
            Button:
                id: settings_button
                markup: True
                background_color: (0, 1.2, 0, 1)
                font_size: "14sp"
                text: '[b]Options[/b]'
                on_release: app.open_settings()
            Button:
                id: quit_button
                markup: True
                background_color: (0, 1.2, 0, 1)
                font_size: "14sp"
                text: '[b]Quitter[/b]'
                on_release: root.do_quit()

<Screen2>:
    name: 'second'
    BoxLayout:  # boite globale
        orientation: 'vertical'
        id: boite_globale
        BoxLayout:  # graph
            size_hint_y: 0.93
            id: graph_id
        BoxLayout:
            size_hint_y: 0.07
            orientation: 'horizontal'
            Button:
                id: recul
                markup: True
                background_color: (0, 1.2, 0, 1)
                font_size: "18sp"
                text: '[b]<<<[/b]'
                on_press: root.do_back_forward(-1)
                on_release: root.do_end()
            Button:
                id: avance
                markup: True
                background_color: (0, 1.2, 0, 1)
                font_size: "18sp"
                text: '[b]>>>[/b]'
                on_press: root.do_back_forward(1)
                on_release: root.do_end()
            Button:
                id: last
                markup: True
                background_color: (0, 1.2, 0, 1)
                font_size: "18sp"
                text: '[b]Reset[/b]'
                on_release: root.do_last()
